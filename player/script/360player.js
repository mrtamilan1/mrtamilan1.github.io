var threeSixtyPlayer,ThreeSixtyPlayer;!function(b){function c(){var v=this,k=this,g=soundManager,j=navigator.userAgent,w=j.match(/msie/i),f=j.match(/opera/i),m=j.match(/safari/i),a=j.match(/chrome/i),h=(j.match(/firefox/i),j.match(/ipad|iphone/i)),q="undefined"==typeof b.G_vmlCanvasManager&&"undefined"!=typeof document.createElement("canvas").getContext("2d"),p=f||a?359.9:360;this.excludeClass="threesixty-exclude",this.links=[],this.sounds=[],this.soundsByURL=[],this.indexByURL=[],this.lastSound=null,this.lastTouchedSound=null,this.soundCount=0,this.oUITemplate=null,this.oUIImageMap=null,this.vuMeter=null,this.callbackCount=0,this.peakDataHistory=[],this.config={playNext:!1,autoPlay:!1,allowMultiple:!1,loadRingColor:"#ccc",playRingColor:"#000",backgroundRingColor:"#eee",segmentRingColor:"rgba(255,255,255,0.33)",segmentRingColorAlt:"rgba(0,0,0,0.1)",loadRingColorMetadata:"#ddd",playRingColorMetadata:"rgba(128,192,256,0.9)",circleDiameter:null,circleRadius:null,animDuration:500,animTransition:b.Animator.tx.bouncy,showHMSTime:!1,scaleFont:!0,useWaveformData:!1,waveformDataColor:"#0099ff",waveformDataDownsample:3,waveformDataOutside:!1,waveformDataConstrain:!1,waveformDataLineRatio:0.64,useEQData:!1,eqDataColor:"#339933",eqDataDownsample:4,eqDataOutside:!0,eqDataLineRatio:0.54,usePeakData:!0,peakDataColor:"#ff33ff",peakDataOutside:!0,peakDataLineRatio:0.5,useAmplifier:!0,fontSizeMax:null,scaleArcWidth:1,useFavIcon:!1},this.css={sDefault:"sm2_link",sBuffering:"sm2_buffering",sPlaying:"sm2_playing",sPaused:"sm2_paused"},this.addEventHandler="undefined"!=typeof b.addEventListener?function(d,i,l){return d.addEventListener(i,l,!1)}:function(d,i,l){d.attachEvent("on"+i,l)},this.removeEventHandler="undefined"!=typeof b.removeEventListener?function(d,i,l){return d.removeEventListener(i,l,!1)}:function(d,i,l){return d.detachEvent("on"+i,l)},this.hasClass=function(d,e){return"undefined"!=typeof d.className?d.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)")):!1},this.addClass=function(d,i){return d&&i&&!v.hasClass(d,i)?void (d.className=(d.className?d.className+" ":"")+i):!1},this.removeClass=function(d,i){return d&&i&&v.hasClass(d,i)?void (d.className=d.className.replace(new RegExp("( "+i+")|("+i+")","g"),"")):!1},this.getElementsByClassName=function(l,y,B){var t,u,A=B||document,z=[],x=[];if("undefined"!=typeof y&&"string"!=typeof y){for(t=y.length;t--;){x&&x[y[t]]||(x[y[t]]=A.getElementsByTagName(y[t]))}}else{x=y?A.getElementsByTagName(y):A.all||A.getElementsByTagName("*")}if("string"!=typeof y){for(t=y.length;t--;){for(u=x[y[t]].length;u--;){v.hasClass(x[y[t]][u],l)&&z.push(x[y[t]][u])}}}else{for(t=0;t<x.length;t++){v.hasClass(x[t],l)&&z.push(x[t])}}return z},this.getParentByNodeName=function(d,e){if(!d||!e){return !1}for(e=e.toLowerCase();d.parentNode&&e!==d.parentNode.nodeName.toLowerCase();){d=d.parentNode}return d.parentNode&&e===d.parentNode.nodeName.toLowerCase()?d.parentNode:null},this.getParentByClassName=function(d,i){if(!d||!i){return !1}for(;d.parentNode&&!v.hasClass(d.parentNode,i);){d=d.parentNode}return d.parentNode&&v.hasClass(d.parentNode,i)?d.parentNode:null},this.getSoundByURL=function(d){return"undefined"!=typeof v.soundsByURL[d]?v.soundsByURL[d]:null},this.isChildOfNode=function(d,e){if(!d||!d.parentNode){return !1}e=e.toLowerCase();do{d=d.parentNode}while(d&&d.parentNode&&d.nodeName.toLowerCase()!==e);return d&&d.nodeName.toLowerCase()===e?d:null},this.isChildOfClass=function(d,i){if(!d||!i){return !1}for(;d.parentNode&&!v.hasClass(d,i);){d=v.findParent(d)}return v.hasClass(d,i)},this.findParent=function(d){if(!d||!d.parentNode){return !1}if(d=d.parentNode,2===d.nodeType){for(;d&&d.parentNode&&2===d.parentNode.nodeType;){d=d.parentNode}}return d},this.getStyle=function(d,i){try{if(d.currentStyle){return d.currentStyle[i]}if(b.getComputedStyle){return document.defaultView.getComputedStyle(d,null).getPropertyValue(i)}}catch(l){}return null},this.findXY=function(d){var i=0,l=0;do{i+=d.offsetLeft,l+=d.offsetTop}while(d=d.offsetParent);return[i,l]},this.getMouseXY=function(d){return d=d?d:b.event,h&&d.touches&&(d=d.touches[0]),d.pageX||d.pageY?[d.pageX,d.pageY]:d.clientX||d.clientY?[d.clientX+v.getScrollLeft(),d.clientY+v.getScrollTop()]:void 0},this.getScrollLeft=function(){return document.body.scrollLeft+document.documentElement.scrollLeft},this.getScrollTop=function(){return document.body.scrollTop+document.documentElement.scrollTop},this.events={play:function(){k.removeClass(this._360data.oUIBox,this._360data.className),this._360data.className=k.css.sPlaying,k.addClass(this._360data.oUIBox,this._360data.className),v.fanOut(this)},stop:function(){k.removeClass(this._360data.oUIBox,this._360data.className),this._360data.className="",v.fanIn(this)},pause:function(){k.removeClass(this._360data.oUIBox,this._360data.className),this._360data.className=k.css.sPaused,k.addClass(this._360data.oUIBox,this._360data.className)},resume:function(){k.removeClass(this._360data.oUIBox,this._360data.className),this._360data.className=k.css.sPlaying,k.addClass(this._360data.oUIBox,this._360data.className)},finish:function(){var d;k.removeClass(this._360data.oUIBox,this._360data.className),this._360data.className="",this._360data.didFinish=!0,v.fanIn(this),k.config.playNext&&(d=k.indexByURL[this._360data.oLink.href]+1,d<k.links.length&&k.handleClick({target:k.links[d]}))},whileloading:function(){this.paused&&v.updatePlaying.apply(this)},whileplaying:function(){v.updatePlaying.apply(this),this._360data.fps++},bufferchange:function(){this.isBuffering?k.addClass(this._360data.oUIBox,k.css.sBuffering):k.removeClass(this._360data.oUIBox,k.css.sBuffering)}},this.stopEvent=function(d){return"undefined"!=typeof d&&"undefined"!=typeof d.preventDefault?d.preventDefault():"undefined"!=typeof b.event&&"undefined"!=typeof b.event.returnValue&&(b.event.returnValue=!1),!1},this.getTheDamnLink=w?function(d){return d&&d.target?d.target:b.event.srcElement}:function(d){return d.target},this.handleClick=function(z){if(z.button>1){return !0}var y,D,t,A,n,x,C,B=v.getTheDamnLink(z);return"a"===B.nodeName.toLowerCase()||(B=v.isChildOfNode(B,"a"))?v.isChildOfClass(B,"ui360")?(D=B.getAttribute("href"),B.href&&g.canPlayLink(B)&&!v.hasClass(B,v.excludeClass)?(g._writeDebug("handleClick()"),t=B.href,A=v.getSoundByURL(t),A?A===v.lastSound?A.togglePause():(A.togglePause(),g._writeDebug("sound different than last sound: "+v.lastSound.id),!v.config.allowMultiple&&v.lastSound&&v.stopSound(v.lastSound)):(n=B.parentNode,x=v.getElementsByClassName("ui360-vis","div",n.parentNode).length,A=g.createSound({id:"ui360Sound"+v.soundCount++,url:t,onplay:v.events.play,onstop:v.events.stop,onpause:v.events.pause,onresume:v.events.resume,onfinish:v.events.finish,onbufferchange:v.events.bufferchange,type:B.type||null,whileloading:v.events.whileloading,whileplaying:v.events.whileplaying,useWaveformData:x&&v.config.useWaveformData,useEQData:x&&v.config.useEQData,usePeakData:x&&v.config.usePeakData}),C=parseInt(v.getElementsByClassName("sm2-360ui","div",n)[0].offsetWidth,10),y=v.getElementsByClassName("sm2-canvas","canvas",n),A._360data={oUI360:v.getParentByClassName(B,"ui360"),oLink:B,className:v.css.sPlaying,oUIBox:v.getElementsByClassName("sm2-360ui","div",n)[0],oCanvas:y[y.length-1],oButton:v.getElementsByClassName("sm2-360btn","span",n)[0],oTiming:v.getElementsByClassName("sm2-timing","div",n)[0],oCover:v.getElementsByClassName("sm2-cover","div",n)[0],circleDiameter:C,circleRadius:C/2,lastTime:null,didFinish:null,pauseCount:0,radius:0,fontSize:1,fontSizeMax:v.config.fontSizeMax,scaleFont:x&&v.config.scaleFont,showHMSTime:x,amplifier:x&&v.config.usePeakData?0.9:1,radiusMax:0.175*C,width:0,widthMax:0.4*C,lastValues:{bytesLoaded:0,bytesTotal:0,position:0,durationEstimate:0},animating:!1,oAnim:new b.Animator({duration:v.config.animDuration,transition:v.config.animTransition,onComplete:function(){}}),oAnimProgress:function(d){var i=this;i._360data.radius=parseInt(i._360data.radiusMax*i._360data.amplifier*d,10),i._360data.width=parseInt(i._360data.widthMax*i._360data.amplifier*d,10),i._360data.scaleFont&&null!==i._360data.fontSizeMax&&(i._360data.oTiming.style.fontSize=parseInt(Math.max(1,i._360data.fontSizeMax*d),10)+"px",i._360data.oTiming.style.opacity=d),(i.paused||0===i.playState||0===i._360data.lastValues.bytesLoaded||0===i._360data.lastValues.position)&&v.updatePlaying.apply(i)},fps:0},"undefined"!=typeof v.Metadata&&v.getElementsByClassName("metadata","div",A._360data.oUI360).length&&(A._360data.metadata=new v.Metadata(A,v)),A._360data.scaleFont&&null!==A._360data.fontSizeMax&&(A._360data.oTiming.style.fontSize="1px"),A._360data.oAnim.addSubject(A._360data.oAnimProgress,A),v.refreshCoords(A),v.updatePlaying.apply(A),v.soundsByURL[t]=A,v.sounds.push(A),!v.config.allowMultiple&&v.lastSound&&v.stopSound(v.lastSound),A.play()),v.lastSound=A,"undefined"!=typeof z&&"undefined"!=typeof z.preventDefault?z.preventDefault():"undefined"!=typeof b.event&&(b.event.returnValue=!1),!1):!0):!0:!0},this.fanOut=function(d){var i=d;return 1===i._360data.animating?!1:(i._360data.animating=0,soundManager._writeDebug("fanOut: "+i.id+": "+i._360data.oLink.href),i._360data.oAnim.seekTo(1),void b.setTimeout(function(){i._360data.animating=0},v.config.animDuration+20))},this.fanIn=function(d){var i=d;return -1===i._360data.animating?!1:(i._360data.animating=-1,soundManager._writeDebug("fanIn: "+i.id+": "+i._360data.oLink.href),i._360data.oAnim.seekTo(0),void b.setTimeout(function(){i._360data.didFinish=!1,i._360data.animating=0,v.resetLastValues(i)},v.config.animDuration+20))},this.resetLastValues=function(d){d._360data.lastValues.position=0},this.refreshCoords=function(d){d._360data.canvasXY=v.findXY(d._360data.oCanvas),d._360data.canvasMid=[d._360data.circleRadius,d._360data.circleRadius],d._360data.canvasMidXY=[d._360data.canvasXY[0]+d._360data.canvasMid[0],d._360data.canvasXY[1]+d._360data.canvasMid[1]]},this.stopSound=function(d){soundManager._writeDebug("stopSound: "+d.id),soundManager.stop(d.id),h||soundManager.unload(d.id)},this.buttonClick=function(d){var i=d?d.target?d.target:d.srcElement:b.event.srcElement;return v.handleClick({target:v.getParentByClassName(i,"sm2-360ui").nextSibling}),!1},this.buttonMouseDown=function(d){return h?v.addEventHandler(document,"touchmove",v.mouseDown):document.onmousemove=function(e){v.mouseDown(e)},v.stopEvent(d),!1},this.mouseDown=function(r){if(!h&&r.button>1){return !0}if(!v.lastSound){return v.stopEvent(r),!1}var u,d,l,t=r?r:b.event;return h&&t.touches&&(t=t.touches[0]),u=t.target||t.srcElement,d=v.getSoundByURL(v.getElementsByClassName("sm2_link","a",v.getParentByClassName(u,"ui360"))[0].href),v.lastTouchedSound=d,v.refreshCoords(d),l=d._360data,v.addClass(l.oUIBox,"sm2_dragging"),l.pauseCount=v.lastTouchedSound.paused?1:0,v.mmh(r?r:b.event),h?(v.removeEventHandler(document,"touchmove",v.mouseDown),v.addEventHandler(document,"touchmove",v.mmh),v.addEventHandler(document,"touchend",v.mouseUp)):(document.onmousemove=v.mmh,document.onmouseup=v.mouseUp),v.stopEvent(r),!1},this.mouseUp=function(){var d=v.lastTouchedSound._360data;v.removeClass(d.oUIBox,"sm2_dragging"),0===d.pauseCount&&v.lastTouchedSound.resume(),h?(v.removeEventHandler(document,"touchmove",v.mmh),v.removeEventHandler(document,"touchend",v.mouseUP)):(document.onmousemove=null,document.onmouseup=null)},this.mmh=function(z){"undefined"==typeof z&&(z=b.event);var C=v.lastTouchedSound,u=v.getMouseXY(z),x=u[0],B=u[1],A=x-C._360data.canvasMidXY[0],y=B-C._360data.canvasMidXY[1],t=Math.floor(p-(v.rad2deg(Math.atan2(A,y))+180));return C.setPosition(C.durationEstimate*(t/p)),v.stopEvent(z),!1},this.drawSolidArc=function(D,B,o,y,F,d,x){var E,C,t,A,z=D;z.getContext&&(E=z.getContext("2d")),D=E,x||v.clearCanvas(z),B&&(E.fillStyle=B),D.beginPath(),isNaN(F)&&(F=0),C=o-y,t=f||m,(!t||t&&o>0)&&(D.arc(0,0,o,d,F,!1),A=v.getArcEndpointCoords(C,F),D.lineTo(A.x,A.y),D.arc(0,0,C,F,d,!0),D.closePath(),D.fill())},this.getArcEndpointCoords=function(d,e){return{x:d*Math.cos(e),y:d*Math.sin(e)}},this.deg2rad=function(d){return d*Math.PI/180},this.rad2deg=function(d){return 180*d/Math.PI},this.getTime=function(d,o){var r=Math.floor(d/1000),s=Math.floor(r/60),l=r-60*s;return o?s+":"+(10>l?"0"+l:l):{min:s,sec:l}},this.clearCanvas=function(d){var o,r,s=d,l=null;s.getContext&&(l=s.getContext("2d")),l&&(o=s.offsetWidth,r=s.offsetHeight,l.clearRect(-(o/2),-(r/2),o,r))},this.updatePlaying=function(){var d=this._360data.showHMSTime?v.getTime(this.position,!0):parseInt(this.position/1000,10),i=v.config.scaleArcWidth;this.bytesLoaded&&(this._360data.lastValues.bytesLoaded=this.bytesLoaded,this._360data.lastValues.bytesTotal=this.bytesTotal),this.position&&(this._360data.lastValues.position=this.position),this.durationEstimate&&(this._360data.lastValues.durationEstimate=this.durationEstimate),v.drawSolidArc(this._360data.oCanvas,v.config.backgroundRingColor,this._360data.width,this._360data.radius*i,v.deg2rad(p),!1),v.drawSolidArc(this._360data.oCanvas,this._360data.metadata?v.config.loadRingColorMetadata:v.config.loadRingColor,this._360data.width,this._360data.radius*i,v.deg2rad(p*(this._360data.lastValues.bytesLoaded/this._360data.lastValues.bytesTotal)),0,!0),0!==this._360data.lastValues.position&&v.drawSolidArc(this._360data.oCanvas,this._360data.metadata?v.config.playRingColorMetadata:v.config.playRingColor,this._360data.width,this._360data.radius*i,v.deg2rad(1===this._360data.didFinish?p:p*(this._360data.lastValues.position/this._360data.lastValues.durationEstimate)),0,!0),this._360data.metadata&&this._360data.metadata.events.whileplaying(),d!==this._360data.lastTime&&(this._360data.lastTime=d,this._360data.oTiming.innerHTML=d),(this.instanceOptions.useWaveformData||this.instanceOptions.useEQData)&&q&&v.updateWaveform(this),v.config.useFavIcon&&v.vuMeter&&v.vuMeter.updateVU(this)},this.updateWaveform=function(O){if(!v.config.useWaveformData&&!v.config.useEQData||!g.features.waveformData&&!g.features.eqData){return !1}if(!O.waveformData.left.length&&!O.eqData.length&&!O.peakData.left){return !1}var L,H,z,E,M,B,G,x,N,F,K,I,J,D,t,n,P=(O._360data.oCanvas.getContext("2d"),parseInt(O._360data.circleDiameter/2,10)),A=P/2;if(v.config.useWaveformData){for(E=v.config.waveformDataDownsample,E=Math.max(1,E),M=256,B=M/E,G=0,x=0,N=null,F=v.config.waveformDataOutside?1:v.config.waveformDataConstrain?0.5:0.565,A=v.config.waveformDataOutside?0.7:0.75,K=v.deg2rad(360/B*v.config.waveformDataLineRatio),L=0;M>L;L+=E){G=v.deg2rad(360*(L/B*1/E)),x=G+K,N=O.waveformData.left[L],0>N&&v.config.waveformDataConstrain&&(N=Math.abs(N)),v.drawSolidArc(O._360data.oCanvas,v.config.waveformDataColor,O._360data.width*F*(2-v.config.scaleArcWidth),O._360data.radius*A*1.25*N,x,G,!0)}}if(v.config.useEQData){for(E=v.config.eqDataDownsample,I=0,E=Math.max(1,E),J=192,B=J/E,F=v.config.eqDataOutside?1:0.565,z=v.config.eqDataOutside?-1:1,A=v.config.eqDataOutside?0.5:0.75,G=0,x=0,K=v.deg2rad(360/B*v.config.eqDataLineRatio),D=v.deg2rad(1===O._360data.didFinish?360:360*(O._360data.lastValues.position/O._360data.lastValues.durationEstimate)),H=0,t=0,L=0;J>L;L+=E){G=v.deg2rad(360*(L/J)),x=G+K,v.drawSolidArc(O._360data.oCanvas,x>D?v.config.eqDataColor:v.config.playRingColor,O._360data.width*F,O._360data.radius*A*O.eqData.left[L]*z,x,G,!0)}}if(v.config.usePeakData&&!O._360data.animating){for(n=O.peakData.left||O.peakData.right,J=3,L=0;J>L;L++){n=n||O.eqData[L]}O._360data.amplifier=v.config.useAmplifier?0.9+0.1*n:1,O._360data.radiusMax=0.175*O._360data.circleDiameter*O._360data.amplifier,O._360data.widthMax=0.4*O._360data.circleDiameter*O._360data.amplifier,O._360data.radius=parseInt(O._360data.radiusMax*O._360data.amplifier,10),O._360data.width=parseInt(O._360data.widthMax*O._360data.amplifier,10)}},this.getUIHTML=function(d){return['<canvas class="sm2-canvas" width="'+d+'" height="'+d+'"></canvas>',' <span class="sm2-360btn sm2-360btn-default"></span>',' <div class="sm2-timing'+(navigator.userAgent.match(/safari/i)?" alignTweak":"")+'"></div>',' <div class="sm2-cover"></div>']},this.uiTest=function(E){var B,y,A,G,x,C,t,z,F,D=document.createElement("div");return D.className="sm2-360ui",B=document.createElement("div"),B.className="ui360"+(E?" "+E:""),y=B.appendChild(D.cloneNode(!0)),B.style.position="absolute",B.style.left="-9999px",A=document.body.appendChild(B),G=y.offsetWidth,x=v.getUIHTML(G),y.innerHTML=x[1]+x[2]+x[3],C=parseInt(y.offsetWidth,10),t=parseInt(C/2,10),F=v.getElementsByClassName("sm2-timing","div",A)[0],z=parseInt(v.getStyle(F,"font-size"),10),isNaN(z)&&(z=null),B.parentNode.removeChild(B),x=B=y=A=null,{circleDiameter:C,circleRadius:t,fontSizeMax:z}},this.init=function(){g._writeDebug("threeSixtyPlayer.init()");var L,H,F,O,B,x,P,G,K,I,J,E,t,s,Q,A=v.getElementsByClassName("ui360","div"),z=[],n=!1,l=0;for(L=0,H=A.length;H>L;L++){z.push(A[L].getElementsByTagName("a")[0]),A[L].style.backgroundImage="none"}for(v.oUITemplate=document.createElement("div"),v.oUITemplate.className="sm2-360ui",v.oUITemplateVis=document.createElement("div"),v.oUITemplateVis.className="sm2-360ui",K=v.uiTest(),v.config.circleDiameter=K.circleDiameter,v.config.circleRadius=K.circleRadius,I=v.uiTest("ui360-vis"),v.config.fontSizeMax=I.fontSizeMax,v.oUITemplate.innerHTML=v.getUIHTML(v.config.circleDiameter).join(""),v.oUITemplateVis.innerHTML=v.getUIHTML(I.circleDiameter).join(""),L=0,H=z.length;H>L;L++){!g.canPlayLink(z[L])||v.hasClass(z[L],v.excludeClass)||v.hasClass(z[L],v.css.sDefault)||(v.addClass(z[L],v.css.sDefault),v.links[l]=z[L],v.indexByURL[z[L].href]=l,l++,n=v.hasClass(z[L].parentNode,"ui360-vis"),P=(n?I:K).circleDiameter,G=(n?I:K).circleRadius,J=z[L].parentNode.insertBefore((n?v.oUITemplateVis:v.oUITemplate).cloneNode(!0),z[L]),w&&"undefined"!=typeof b.G_vmlCanvasManager?(t=z[L].parentNode,s=document.createElement("canvas"),s.className="sm2-canvas",Q="sm2_canvas_"+L+(new Date).getTime(),s.id=Q,s.width=P,s.height=P,J.appendChild(s),b.G_vmlCanvasManager.initElement(s),O=document.getElementById(Q),F=O.parentNode.getElementsByTagName("canvas"),F.length>1&&(O=F[F.length-1])):O=z[L].parentNode.getElementsByTagName("canvas")[0],x=v.getElementsByClassName("sm2-cover","div",z[L].parentNode)[0],E=z[L].parentNode.getElementsByTagName("span")[0],v.addEventHandler(E,"click",v.buttonClick),h?v.addEventHandler(x,"touchstart",v.mouseDown):v.addEventHandler(x,"mousedown",v.mouseDown),B=O.getContext("2d"),B.translate(G,G),B.rotate(v.deg2rad(-90)))}l>0&&(v.addEventHandler(document,"click",v.handleClick),v.config.autoPlay&&v.handleClick({target:v.links[0],preventDefault:function(){}})),g._writeDebug("threeSixtyPlayer.init(): Found "+l+" relevant items."),v.config.useFavIcon&&"undefined"!=typeof this.VUMeter&&(this.vuMeter=new this.VUMeter(this))}}c.prototype.VUMeter=function(d){var g=d,j=this,k=document.getElementsByTagName("head")[0],f=navigator.userAgent.match(/opera/i),h=navigator.userAgent.match(/firefox/i);this.vuMeterData=[],this.vuDataCanvas=null,this.setPageIcon=function(i){if(!g.config.useFavIcon||!g.config.usePeakData||!i){return !1}var l=document.getElementById("sm2-favicon");l&&(k.removeChild(l),l=null),l||(l=document.createElement("link"),l.id="sm2-favicon",l.rel="shortcut icon",l.type="image/png",l.href=i,document.getElementsByTagName("head")[0].appendChild(l))},this.resetPageIcon=function(){if(!g.config.useFavIcon){return !1}var e=document.getElementById("favicon");e&&(e.href="/favicon.ico")},this.updateVU=function(e){soundManager.flashVersion>=9&&g.config.useFavIcon&&g.config.usePeakData&&j.setPageIcon(j.vuMeterData[parseInt(16*e.peakData.left,10)][parseInt(16*e.peakData.right,10)])},this.createVUData=function(){var e=0,m=0,r=j.vuDataCanvas.getContext("2d"),l=r.createLinearGradient(0,16,0,0),p=r.createLinearGradient(0,16,0,0),q="rgba(0,0,0,0.2)";for(l.addColorStop(0,"rgb(0,192,0)"),l.addColorStop(0.3,"rgb(0,255,0)"),l.addColorStop(0.625,"rgb(255,255,0)"),l.addColorStop(0.85,"rgb(255,0,0)"),p.addColorStop(0,q),p.addColorStop(1,"rgba(0,0,0,0.5)"),e=0;16>e;e++){j.vuMeterData[e]=[]}for(e=0;16>e;e++){for(m=0;16>m;m++){j.vuDataCanvas.setAttribute("width",16),j.vuDataCanvas.setAttribute("height",16),r.fillStyle=p,r.fillRect(0,0,7,15),r.fillRect(8,0,7,15),r.fillStyle=l,r.fillRect(0,15-e,7,16-(16-e)),r.fillRect(8,15-m,7,16-(16-m)),r.clearRect(0,3,16,1),r.clearRect(0,7,16,1),r.clearRect(0,11,16,1),j.vuMeterData[e][m]=j.vuDataCanvas.toDataURL("image/png")}}},this.testCanvas=function(){var i,l=document.createElement("canvas"),m=null;if(!l||"undefined"==typeof l.getContext){return null}if(m=l.getContext("2d"),!m||"function"!=typeof l.toDataURL){return null}try{i=l.toDataURL("image/png")}catch(o){return null}return l},this.init=function(){g.config.useFavIcon&&(j.vuDataCanvas=j.testCanvas(),j.vuDataCanvas&&(h||f)?j.createVUData():g.config.useFavIcon=!1)},this.init()},c.prototype.Metadata=function(f,h){soundManager._wD("Metadata()");var k,p,g=this,j=f._360data.oUI360,m=j.getElementsByTagName("ul")[0],l=m.getElementsByTagName("li");for(navigator.userAgent.match(/firefox/i),this.lastWPExec=0,this.refreshInterval=250,this.totalTime=0,this.events={whileplaying:function(){var t,w,i,v=f._360data.width,u=f._360data.radius,q=f.durationEstimate||1000*g.totalTime,a=null;for(t=0,w=g.data.length;w>t;t++){a=t%2===0,h.drawSolidArc(f._360data.oCanvas,a?h.config.segmentRingColorAlt:h.config.segmentRingColor,a?v:v,a?u/2:u/2,h.deg2rad(360*(g.data[t].endTimeMS/q)),h.deg2rad(360*((g.data[t].startTimeMS||1)/q)),!0)}i=new Date,i-g.lastWPExec>g.refreshInterval&&(g.refresh(),g.lastWPExec=i)}},this.refresh=function(){var d,q,r=null,a=f.position,o=f._360data.metadata.data;for(d=0,q=o.length;q>d;d++){if(a>=o[d].startTimeMS&&a<=o[d].endTimeMS){r=d;break}}r!==o.currentItem&&r<o.length&&(f._360data.oLink.innerHTML=o.mainTitle+' <span class="metadata"><span class="sm2_divider"> | </span><span class="sm2_metadata">'+o[r].title+"</span></span>",o.currentItem=r)},this.strToTime=function(d){var i,o=d.split(":"),q=0;for(i=o.length;i--;){q+=parseInt(o[i],10)*Math.pow(60,o.length-1-i)}return q},this.data=[],this.data.givenDuration=null,this.data.currentItem=null,this.data.mainTitle=f._360data.oLink.innerHTML,k=0;k<l.length;k++){this.data[k]={o:null,title:l[k].getElementsByTagName("p")[0].innerHTML,startTime:l[k].getElementsByTagName("span")[0].innerHTML,startSeconds:g.strToTime(l[k].getElementsByTagName("span")[0].innerHTML.replace(/[()]/g,"")),duration:0,durationMS:null,startTimeMS:null,endTimeMS:null,oNote:null}}for(p=h.getElementsByClassName("duration","div",j),this.data.givenDuration=p.length?1000*g.strToTime(p[0].innerHTML):0,k=0;k<this.data.length;k++){this.data[k].duration=parseInt(this.data[k+1]?this.data[k+1].startSeconds:(g.data.givenDuration?g.data.givenDuration:f.durationEstimate)/1000,10)-this.data[k].startSeconds,this.data[k].startTimeMS=1000*this.data[k].startSeconds,this.data[k].durationMS=1000*this.data[k].duration,this.data[k].endTimeMS=this.data[k].startTimeMS+this.data[k].durationMS,this.totalTime+=this.data[k].duration}},navigator.userAgent.match(/webkit/i)&&navigator.userAgent.match(/mobile/i)&&soundManager.setup({useHTML5Audio:!0}),soundManager.setup({html5PollingInterval:50,debugMode:b.location.href.match(/debug=1/i),consoleOnly:!0,flashVersion:9,useHighPerformance:!0,useFlashBlock:!0}),soundManager.debugMode&&b.setInterval(function(){var a=b.threeSixtyPlayer;a&&a.lastSound&&a.lastSound._360data.fps&&"undefined"==typeof b.isHome&&(soundManager._writeDebug("fps: ~"+a.lastSound._360data.fps),a.lastSound._360data.fps=0)},1000),b.ThreeSixtyPlayer=c}(window),threeSixtyPlayer=new ThreeSixtyPlayer,soundManager.onready(threeSixtyPlayer.init);